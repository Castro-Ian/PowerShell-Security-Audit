# MalwareDetection.ps1
# PowerShell script to scan for malicious processes, suspicious files, and run Windows Defender.

# Function to scan processes for known malicious or suspicious names
function Check-MaliciousProcesses {
    Write-Host "Checking running processes for suspicious names..."
    
    # List of known malicious or suspicious process names (as an example)
    $maliciousProcesses = @(
        "malware.exe",
        "virus.exe",
        "trojan.exe",
        "cryptominer.exe"
    )

    # Get all running processes
    $runningProcesses = Get-Process | Select-Object -Property Name, Id

    foreach ($process in $runningProcesses) {
        if ($maliciousProcesses -contains $process.Name) {
            Write-Host "WARNING: Malicious process detected - $($process.Name) (PID: $($process.Id))" -ForegroundColor Red
        }
    }

    Write-Host "Process check completed."
}

# Function to scan specific directories for suspicious or malicious files
function Check-SuspiciousFiles {
    Write-Host "Scanning for suspicious files..."

    # Directories commonly targeted by malware
    $scanPaths = @(
        "$env:Temp",
        "$env:AppData",
        "$env:ProgramData"
    )

    # List of known suspicious or malicious file extensions
    $suspiciousExtensions = @(".exe", ".bat", ".vbs", ".ps1")

    foreach ($path in $scanPaths) {
        if (Test-Path $path) {
            $files = Get-ChildItem -Path $path -Recurse | Where-Object { $suspiciousExtensions -contains $_.Extension }
            foreach ($file in $files) {
                Write-Host "WARNING: Suspicious file found - $($file.FullName)" -ForegroundColor Yellow
            }
        } else {
            Write-Host "Path not found: $path"
        }
    }

    Write-Host "File scan completed."
}

# Function to run Windows Defender quick scan (if available)
function Run-WindowsDefenderScan {
    Write-Host "Checking for Windows Defender..."

    if (Get-Command -Name "Start-MpScan" -ErrorAction SilentlyContinue) {
        Write-Host "Running Windows Defender quick scan..."
        Start-MpScan -ScanType QuickScan
        Write-Host "Windows Defender scan initiated."
    } else {
        Write-Host "Windows Defender not available on this system."
    }
}

# Main execution
Write-Host "Starting malware detection scan..."

Check-MaliciousProcesses
Check-SuspiciousFiles
Run-WindowsDefenderScan

Write-Host "Malware detection scan completed."
